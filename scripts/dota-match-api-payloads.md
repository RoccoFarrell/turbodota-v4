# Dota 2 match API payloads (inspect script output)

Generated by `scripts/inspect-dota-match-apis.ts`. Use for reward/lootbox design.

## 1. OpenDota – Player matches list

**Endpoint:** `GET https://api.opendota.com/api/players/{account_id}/matches?significant=0&date=30&limit=5`

*Set `OPENDOTA_ACCOUNT_ID` and re-run to fetch. From code/schema we use:*

- `match_id`, `start_time`, `player_slot`, `radiant_win`, `hero_id`, `kills`, `deaths`, `assists`, `duration`, `game_mode`, `leaver_status`, `average_rank` (and optionally more from OpenDota list).

- **Stored in DB `Match`:** match_id, account_id, kills, assists, deaths, duration, game_mode, hero_id, player_slot, radiant_win, start_time, average_rank, leaver_status, lobby_type, party_size, skill, hero_variant, version.

## 2. OpenDota – Match details

**Endpoint:** `GET https://api.opendota.com/api/matches/{match_id}`

**Match-level keys:** match_id, barracks_status_dire, barracks_status_radiant, chat, cluster, cosmetics, dire_score, dire_team_id, draft_timings, duration, engine, first_blood_time, game_mode, human_players, leagueid, lobby_type, match_seq_num, negative_votes, objectives, picks_bans, positive_votes, radiant_gold_adv, radiant_score, radiant_team_id, radiant_win, radiant_xp_adv, skill, start_time, teamfights, tower_status_dire, tower_status_radiant, version, pre_game_duration, flags, od_data, metadata, patch, region, all_word_counts, my_word_counts, comeback, stomp

**Player-level keys (first player):** match_id, player_slot, ability_targets, ability_upgrades_arr, ability_uses, account_id, actions, additional_units, assists, backpack_0, backpack_1, backpack_2, backpack_3, buyback_log, camps_stacked, connection_log, creeps_stacked, damage, damage_inflictor, damage_inflictor_received, damage_taken, damage_targets, deaths, denies, dn_t, firstblood_claimed, gold, gold_per_min, gold_reasons, gold_spent, gold_t, hero_damage, hero_healing, hero_hits, hero_id, item_0, item_1, item_2, item_3, item_4, item_5, item_neutral, item_uses, kill_streaks, killed, killed_by, kills, kills_log, lane_pos, last_hits, leaver_status, level, lh_t, life_state, max_hero_hit, multi_kills, net_worth, obs, obs_left_log, obs_log, obs_placed, party_id, party_size, performance_others, permanent_buffs, pings, pred_vict, purchase, purchase_log, randomed, repicked, roshans_killed, rune_pickups, runes, runes_log, sen, sen_left_log, sen_log, sen_placed, stuns, teamfight_participation, times, tower_damage, towers_killed, xp_per_min, xp_reasons, xp_t, team_number, team_slot, hero_variant, item_neutral2, aghanims_scepter, aghanims_shard, moonshard, is_subscriber, radiant_win, start_time, duration, cluster, lobby_type, game_mode, is_contributor, patch, region, isRadiant, win, lose, total_gold, total_xp, kills_per_min, kda, abandons, neutral_kills, tower_kills, courier_kills, lane_kills, hero_kills, observer_kills, sentry_kills, roshan_kills, necronomicon_kills, ancient_kills, buyback_count, observer_uses, sentry_uses, lane_efficiency, lane_efficiency_pct, lane, lane_role, is_roaming, purchase_time, first_purchase_time, item_win, item_usage, purchase_ward_observer, purchase_ward_sentry, purchase_tpscroll, actions_per_min, life_state_dead, cosmetics, benchmarks

**Sample player (first):**
```json
{
  "match_id": 4896520517,
  "player_slot": 0,
  "ability_targets": {},
  "ability_upgrades_arr": [
    5062,
    5061,
    5061,
    5062,
    5061,
    5062,
    5061,
    5062,
    5949,
    5064,
    5063,
    5064,
    5063,
    6141,
    5063,
    5063,
    5064,
    6670,
    6445
  ],
  "ability_uses": {
    "nevermore_shadowraze2": 21,
    "nevermore_shadowraze1": 14,
    "nevermore_shadowraze3": 15,
    "nevermore_requiem": 6
  },
  "account_id": null,
  "actions": {
    "1": 7501,
    "2": 8,
    "3": 132,
    "4": 1207,
    "5": 14,
    "6": 7,
    "7": 4,
    "8": 266,
    "10": 97,
    "11": 15,
    "12": 2,
    "14": 29,
    "15": 12,
    "16": 56,
    "17": 5,
    "19": 53,
    "24": 1,
    "27": 2,
    "33": 97
  },
  "additional_units": null,
  "assists": 7,
  "backpack_0": 38,
  "backpack_1": 41,
  "backpack_2": 0,
  "backpack_3": null,
  "buyback_log": [],
  "camps_stacked": 0,
  "connection_log": [],
  "creeps_stacked": 0,
  "damage": {
    "npc_dota_hero_templar_assassin": 5621,
    "npc_dota_creep_badguys_melee": 25944,
    "npc_dota_creep_goodguys_melee": 825,
    "npc_dota_creep_badguys_ranged": 8775,
    "npc_dota_templar_assassin_psionic_trap": 649,
    "npc_dota_creep_goodguys_ranged": 100,
    "npc_dota_badguys_siege": 1662,
    "npc_dota_hero_tusk": 6871,
    "npc_dota_neutral_granite_golem": 2500,
    "npc_dota_hero_skywrath_mage": 2135,
    "npc_dota_neutral_rock_golem": 2486,
    "npc_dota_hero_ancient_apparition": 1131,
    "npc_dota_badguys_tower1_mid": 55,
    "npc_dota_neutral_centaur_outrunner": 2051,
    "npc_dota_neutral_centaur_khan": 3463,
    "npc_dota_neutral_satyr_hellcaller": 3573,
    "npc_dota_neutral_satyr_trickster": 2529,
    "npc_dota_neutral_satyr_soulstealer": 5199,
    "npc_dota_hero_phantom_assassin": 14537,
    "npc_dota_neutral_alpha_wolf": 2047,
    "npc_dota_neutral_giant_wolf": 4445,
    "npc_dota_neutral_ogre_magi": 2007,
    "npc_dota_neutral_ogre_mauler": 5097,
    "npc_dota_neutral_dark_troll_warlord"
```

## 3. Stratz – Player matches (GraphQL)

**Endpoint:** `POST https://api.stratz.com/graphql` with Bearer token.

**Query:** `player(steamAccountId)` → `matches(request: { take, gameModeIds })` → `id`, `durationSeconds`, `didRadiantWin`, `players(steamAccountId)` → `heroId`, `kills`, `assists`, `deaths`, `heroDamage`, `towerDamage`, `heroHealing`, `award`, `imp`, etc.

*Set `STRATZ_TOKEN` and `OPENDOTA_ACCOUNT_ID` to fetch. From code we use:*

- Match: `id`, `gameMode`, `startDateTime`, `endDateTime`, `durationSeconds`, `didRadiantWin`, `averageRank`, `isStats`.

- Player: `heroId`, `kills`, `assists`, `deaths`, `isVictory`, `leaverStatus`, `playerSlot`, `award`, `imp`, `heroDamage`, `towerDamage`, `heroHealing`.

## 4. Stats available for rewards (summary)

| Source | Available in list (no extra call) | Available in detail (per match fetch) |

|--------|-----------------------------------|--------------------------------------|

| **OpenDota** | match_id, start_time, duration, radiant_win, game_mode, hero_id, player_slot, kills, deaths, assists (from list), leaver_status, rank | Full match: duration, first_blood_time, patch, scores; Per player: kills, deaths, assists, last_hits, denies, gpm, xpm, level, net_worth, hero_damage, tower_damage, hero_healing, items (0-5, backpack, neutral), aghs/shard/moonshard, gold, total_gold, total_xp, kda, benchmarks |

| **Stratz** | id, durationSeconds, didRadiantWin, players: heroId, kills, assists, deaths, heroDamage, towerDamage, heroHealing, award, imp | Same in one query (no separate detail call) |

| **Our DB Match** | match_id, account_id, hero_id, player_slot, radiant_win, start_time, game_mode, kills, deaths, assists, duration | Join MatchDetail/PlayersMatchDetail for hero_damage, hero_healing, tower_damage, last_hits, items, etc. |
